from SONALI import app 
import asyncio
import random
from pyrogram import Client, filters
from pyrogram.enums import ChatType, ChatMemberStatus
from pyrogram.errors import UserNotParticipant
from pyrogram.types import ChatPermissions

spam_chats = []

EMOJI = [ "ğŸ¦‹ğŸ¦‹ğŸ¦‹ğŸ¦‹ğŸ¦‹",
          "ğŸ§šğŸŒ¸ğŸ§‹ğŸ¬ğŸ«–",
          "ğŸ¥€ğŸŒ·ğŸŒ¹ğŸŒºğŸ’",
          "ğŸŒ¸ğŸŒ¿ğŸ’®ğŸŒ±ğŸŒµ",
          "â¤ï¸ğŸ’šğŸ’™ğŸ’œğŸ–¤",
          "ğŸ’“ğŸ’•ğŸ’ğŸ’—ğŸ’–",
          "ğŸŒ¸ğŸ’ğŸŒºğŸŒ¹ğŸ¦‹",
          "ğŸ”ğŸ¦ªğŸ›ğŸ²ğŸ¥—",
          "ğŸğŸ“ğŸ’ğŸ‘ğŸŒ¶ï¸",
          "ğŸ§‹ğŸ¥¤ğŸ§‹ğŸ¥›ğŸ·",
          "ğŸ¬ğŸ­ğŸ§ğŸ‚ğŸ¡",
          "ğŸ¨ğŸ§‰ğŸºâ˜•ğŸ»",
          "ğŸ¥ªğŸ¥§ğŸ¦ğŸ¥ğŸš",
          "ğŸ«–â˜•ğŸ¹ğŸ·ğŸ¥›",
          "â˜•ğŸ§ƒğŸ©ğŸ¦ğŸ™",
          "ğŸğŸŒ¾ğŸ’®ğŸ‚ğŸŒ¿",
          "ğŸŒ¨ï¸ğŸŒ¥ï¸â›ˆï¸ğŸŒ©ï¸ğŸŒ§ï¸",
          "ğŸŒ·ğŸµï¸ğŸŒ¸ğŸŒºğŸ’",
          "ğŸ’®ğŸŒ¼ğŸŒ»ğŸ€ğŸ",
          "ğŸ§ŸğŸ¦¸ğŸ¦¹ğŸ§™ğŸ‘¸",
          "ğŸ§…ğŸ ğŸ¥•ğŸŒ½ğŸ¥¦",
          "ğŸ·ğŸ¹ğŸ­ğŸ¨ğŸ»â€â„ï¸",
          "ğŸ¦‹ğŸ‡ğŸ€ğŸˆğŸˆâ€â¬›",
          "ğŸŒ¼ğŸŒ³ğŸŒ²ğŸŒ´ğŸŒµ",
          "ğŸ¥©ğŸ‹ğŸğŸˆğŸ‡",
          "ğŸ´ğŸ½ï¸ğŸ”ªğŸ¶ğŸ¥ƒ",
          "ğŸ•ŒğŸ°ğŸ©â›©ï¸ğŸ©",
          "ğŸ‰ğŸŠğŸˆğŸ‚ğŸ€",
          "ğŸª´ğŸŒµğŸŒ´ğŸŒ³ğŸŒ²",
          "ğŸ„ğŸ‹ğŸğŸ‘ğŸ",
          "ğŸ¦…ğŸ¦œğŸ•Šï¸ğŸ¦¤ğŸ¦¢",
          "ğŸ¦¤ğŸ¦©ğŸ¦šğŸ¦ƒğŸ¦†",
          "ğŸ¬ğŸ¦­ğŸ¦ˆğŸ‹ğŸ³",
          "ğŸ”ğŸŸğŸ ğŸ¡ğŸ¦",
          "ğŸ¦©ğŸ¦€ğŸ¦‘ğŸ™ğŸ¦ª",
          "ğŸ¦ğŸ¦‚ğŸ•·ï¸ğŸ•¸ï¸ğŸš",
          "ğŸ¥ªğŸ°ğŸ¥§ğŸ¨ğŸ¨",
          " ğŸ¥¬ğŸ‰ğŸ§ğŸ§‡",
        ]
        ####
        
gntag = [ " É¢á´á´á´… É´ÉªÉ¢Êœá´› ğŸŒš ",
            "  á´„Êœá´œá´˜ á´„Êœá´€á´˜ sá´ á´Šá´€ ğŸ™Š ",
            "  á´˜Êœá´É´á´‡ Ê€á´€á´‹Êœ á´‹á´€Ê€ sá´ á´Šá´€, É´á´€ÊœÉª á´›á´ Ê™Êœá´á´á´› á´€á´€ á´Šá´€Êá´‡É¢á´€..ğŸ‘» ",
            "  á´€á´¡á´‡á´‡ Ê™á´€Ê™á´œ sá´É´á´€ á´…ÉªÉ´ á´á´‡ÉªÉ´ á´‹á´€Ê€ ÊŸá´‡É´á´€ á´€Ê™ÊœÉª sá´ á´Šá´€á´..?? ğŸ¥² ",
            "  á´á´œá´á´Ê á´…á´‡á´‹Êœá´ Êá´‡ á´€á´˜É´á´‡ É¢Ò“ sá´‡ Ê™á´€á´€á´› á´‹Ê€ Ê€Êœá´€ Êœ Ê€á´€á´Šá´€Éª á´á´‡ É¢Êœá´œs á´‹á´€Ê€, sá´ É´á´€ÊœÉª Ê€á´€Êœá´€ ğŸ˜œ ",
            "  á´˜á´€á´˜á´€ Êá´‡ á´…á´‡á´‹Êœá´ á´€á´˜É´á´‡ Ê™á´‡á´›á´‡ á´‹á´ Ê€á´€á´€á´› Ê™Êœá´€Ê€ á´˜Êœá´É´á´‡ á´„Êœá´€ÊŸá´€ Ê€Êœá´€ Êœá´€Éª ğŸ¤­ ",
            "  á´Šá´€É´á´œ á´€á´€á´Š Ê€á´€á´€á´› á´‹á´€ sá´„á´‡É´á´‡ Ê™É´á´€ ÊŸá´‡..?? ğŸŒ  ",
            "  É¢É´ sá´… á´›á´„.. ğŸ™‚ ",
            "  É¢á´á´á´… É´ÉªÉ¢Êœá´› sá´¡á´‡á´‡á´› á´…Ê€á´‡á´€á´ á´›á´€á´‹á´‡ á´„á´€Ê€á´‡..?? âœ¨ ",
            "  Ê€á´€á´€á´› Ê™Êœá´œá´› Êœá´ É¢ÊÉª Êœá´€Éª sá´ á´Šá´€á´, É¢É´..?? ğŸŒŒ ",
            "  á´á´œá´á´Ê á´…á´‡á´‹Êœá´ 11 Ê™á´€á´ŠÉ´á´‡ á´¡á´€ÊŸá´‡ Êœá´€Éª Êá´‡ á´€Ê™ÊœÉª á´›á´€á´‹ á´˜Êœá´É´á´‡ á´„Êœá´€ÊŸá´€ Ê€Êœá´€ É´á´€ÊœÉª sá´ É´á´€ÊœÉª Ê€Êœá´€ ğŸ•¦ ",
            "  á´‹á´€ÊŸ sá´œÊ™Êœá´€ sá´„Êœá´á´ÊŸ É´á´€ÊœÉª á´Šá´€É´á´€ á´‹Êá´€, á´Šá´ á´€Ê™ÊœÉª á´›á´€á´‹ á´Šá´€É¢ Ê€Êœá´‡ Êœá´ ğŸ« ",
            "  Ê™á´€Ê™á´œ, É¢á´á´á´… É´ÉªÉ¢Êœá´› sá´… á´›á´„..?? ğŸ˜Š ",
            "  á´€á´€á´Š Ê™Êœá´œá´› á´›Êœá´€É´á´… Êœá´€Éª, á´€á´€Ê€á´€á´ sá´‡ á´Šá´€ÊŸá´…Éª sá´ á´Šá´€á´›Éª Êœá´á´É´ ğŸŒ¼ ",
            "  á´Šá´€É´á´‡á´á´€É´, É¢á´á´á´… É´ÉªÉ¢Êœá´› ğŸŒ· ",
            "  á´á´‡ á´Šá´€ Ê€á´€ÊœÉª sá´É´á´‡, É¢É´ sá´… á´›á´„ ğŸµï¸ ",
            "  Êœá´‡ÊŸÊŸá´ á´ŠÉª É´á´€á´á´€sá´›á´‡, É¢á´á´á´… É´ÉªÉ¢Êœá´› ğŸƒ ",
            "  Êœá´‡Ê, Ê™á´€Ê™Ê á´‹á´‹Ê€Êœ..? sá´É´á´€ É´á´€ÊœÉª Êœá´€Éª á´‹Êá´€ â˜ƒï¸ ",
            "  É¢á´á´á´… É´ÉªÉ¢Êœá´› á´ŠÉª, Ê™Êœá´œá´› Ê€á´€á´€á´› Êœá´ É¢ÊÉª..? â›„ ",
            "  á´á´‡ á´Šá´€ Ê€á´€ÊœÉª Ê€á´É´á´‡, Éª á´á´‡á´€É´ sá´É´á´‡ É¢á´á´á´… É´ÉªÉ¢Êœá´› á´ŠÉª ğŸ˜ ",
            "  á´á´€á´„ÊœÊœá´€ÊŸÉª á´‹á´ á´‹á´‡Êœá´›á´‡ Êœá´€Éª Ò“ÉªsÊœ, É¢á´á´á´… É´ÉªÉ¢Êœá´› á´…á´‡á´€Ê€ á´á´€á´› á´‹Ê€É´á´€ á´Éªss, á´Šá´€ Ê€ÊœÉª sá´É´á´‡ ğŸŒ„ ",
            "  É¢á´á´á´… É´ÉªÉ¢Êœá´› Ê™Ê€ÉªÉ¢Êœá´›Ò“á´œÊŸÊŸ É´ÉªÉ¢Êœá´› ğŸ¤­ ",
            "  á´›Êœá´‡ É´ÉªÉ¢Êœá´› Êœá´€s Ò“á´€ÊŸÊŸá´‡É´, á´›Êœá´‡ á´…á´€Ê Éªs á´…á´É´á´‡,, á´›Êœá´‡ á´á´á´É´ Êœá´€s á´›á´€á´‹á´‡É´ á´›Êœá´‡ á´˜ÊŸá´€á´„á´‡ á´Ò“ á´›Êœá´‡ sá´œÉ´... ğŸ˜Š ",
            "  á´á´€Ê á´€ÊŸÊŸ Êá´á´œÊ€ á´…Ê€á´‡á´€á´s á´„á´á´á´‡ á´›Ê€á´œá´‡ â¤ï¸ ",
            "  É¢á´á´á´… É´ÉªÉ¢Êœá´› sá´˜Ê€ÉªÉ´á´‹ÊŸá´‡s sá´¡á´‡á´‡á´› á´…Ê€á´‡á´€á´ ğŸ’š ",
            "  É¢á´á´á´… É´ÉªÉ¢Êœá´›, É´ÉªÉ´á´… á´€á´€ Ê€ÊœÉª Êœá´€Éª ğŸ¥± ",
            "  á´…á´‡á´€Ê€ Ò“Ê€Éªá´‡É´á´… É¢á´á´á´… É´ÉªÉ¢Êœá´› ğŸ’¤ ",
            "  Ê™á´€Ê™Ê á´€á´€á´Š Ê€á´€á´€á´› á´‹á´€ sá´„á´‡É´á´‡ Ê™É´á´€ ÊŸá´‡ ğŸ¥° ",
            "  Éªá´›É´Éª Ê€á´€á´€á´› á´á´‡ á´Šá´€É¢ á´‹á´€Ê€ á´‹Êá´€ á´‹á´€Ê€ Ê€Êœá´‡ Êœá´ sá´É´á´€ É´á´€ÊœÉª Êœá´€Éª á´‹Êá´€ ğŸ˜œ ",
            "  á´„ÊŸá´sá´‡ Êá´á´œÊ€ á´‡Êá´‡s sÉ´á´œÉ¢É¢ÊŸá´‡ á´œá´˜ á´›ÉªÉ¢Êœá´›,, á´€É´á´… Ê€á´‡á´á´‡á´Ê™á´‡Ê€ á´›Êœá´€á´› á´€É´É¢á´‡ÊŸs, á´¡ÉªÊŸÊŸ á´¡á´€á´›á´„Êœ á´á´ á´‡Ê€ Êá´á´œ á´›á´É´ÉªÉ¢Êœá´›... ğŸ’« ",
           ] 

# Command
    


@app.on_message(filters.command(["gntag" ], prefixes=["/", "@", "#"]))
async def mentionall(client, message):
    chat_id = message.chat.id
    if message.chat.type == ChatType.PRIVATE:
        return await message.reply("ğ“ğ¡ğ¢ğ¬ ğ‚ğ¨ğ¦ğ¦ğšğ§ğ ğğ§ğ¥ğ² ğ…ğ¨ğ« ğ†ğ«ğ¨ğ®ğ©ğ¬.")

    is_admin = False
    try:
        participant = await client.get_chat_member(chat_id, message.from_user.id)
    except UserNotParticipant:
        is_admin = False
    else:
        if participant.status in (
            ChatMemberStatus.ADMINISTRATOR,
            ChatMemberStatus.OWNER
        ):
            is_admin = True
    if not is_admin:
        return await message.reply("ğ˜ğ¨ğ® ğ€ğ«ğ ğğ¨ğ­ ğ€ğğ¦ğ¢ğ§ ğğšğ›ğ², ğğ§ğ¥ğ² ğ€ğğ¦ğ¢ğ§ğ¬ ğ‚ğšğ§ . ")

    if message.reply_to_message and message.text:
        return await message.reply("/gntagl  ğ“ğ²ğ©ğ ğ‹ğ¢ğ¤ğ ğ“ğ¡ğ¢ğ¬ / ğ‘ğğ©ğ¥ğ² ğ€ğ§ğ² ğŒğğ¬ğ¬ğšğ ğ ğğğ±ğ­ ğ“ğ¢ğ¦ğ ")
    elif message.text:
        mode = "text_on_cmd"
        msg = message.text
    elif message.reply_to_message:
        mode = "text_on_reply"
        msg = message.reply_to_message
        if not msg:
            return await message.reply("/gntag  ğ“ğ²ğ©ğ ğ‹ğ¢ğ¤ğ ğ“ğ¡ğ¢ğ¬ / ğ‘ğğ©ğ¥ğ² ğ€ğ§ğ² ğŒğğ¬ğ¬ğšğ ğ ğğğ±ğ­ ğ“ğ¢ğ¦ğ ...")
    else:
        return await message.reply("/gntag  ğ“ğ²ğ©ğ ğ‹ğ¢ğ¤ğ ğ“ğ¡ğ¢ğ¬ / ğ‘ğğ©ğ¥ğ² ğ€ğ§ğ² ğŒğğ¬ğ¬ğšğ ğ ğğğ±ğ­ ğ“ğ¢ğ¦ğ ..")
    if chat_id in spam_chats:
        return await message.reply("ğğ¥ğğšğ¬ğ ğ€ğ­ ğ…ğ¢ğ«ğ¬ğ­ ğ’ğ­ğ¨ğ© ğ‘ğ®ğ§ğ§ğ¢ğ§ğ  ğğ«ğ¨ğœğğ¬ğ¬ ...")
    spam_chats.append(chat_id)
    usrnum = 0
    usrtxt = ""
    async for usr in client.get_chat_members(chat_id):
        if not chat_id in spam_chats:
            break
        if usr.user.is_bot:
            continue
        usrnum += 1
        usrtxt += "<a href='tg://user?id={}'>{}</a>".format(usr.user.id, usr.user.first_name)

        if usrnum == 1:
            if mode == "text_on_cmd":
                txt = f"{usrtxt} {random.choice(gntag)}"
                await client.send_message(chat_id, txt)
            elif mode == "text_on_reply":
                await msg.reply(f"[{random.choice(EMOJI)}](tg://user?id={usr.user.id})")
            await asyncio.sleep(4)
            usrnum = 0
            usrtxt = ""
    try:
        spam_chats.remove(chat_id)
    except:
        pass


#

@app.on_message(filters.command(["cancelgntag", "gntagoff"]))
async def cancel_spam(client, message):
    if not message.chat.id in spam_chats:
        return await message.reply("ğ‚ğ®ğ«ğ«ğğ§ğ­ğ¥ğ² ğˆ'ğ¦ ğğ¨ğ­ ..")
    is_admin = False
    try:
        participant = await client.get_chat_member(message.chat.id, message.from_user.id)
    except UserNotParticipant:
        is_admin = False
    else:
        if participant.status in (
            ChatMemberStatus.ADMINISTRATOR,
            ChatMemberStatus.OWNER
        ):
            is_admin = True
    if not is_admin:
        return await message.reply("ğ˜ğ¨ğ® ğ€ğ«ğ ğğ¨ğ­ ğ€ğğ¦ğ¢ğ§ ğğšğ›ğ², ğğ§ğ¥ğ² ğ€ğğ¦ğ¢ğ§ğ¬ ğ‚ğšğ§ ğ“ğšğ  ğŒğğ¦ğ›ğğ«ğ¬.")
    else:
        try:
            spam_chats.remove(message.chat.id)
        except:
            pass
        return await message.reply(" á´˜Ê€ÉªÉ´á´„á´‡ á´ á´„á´›á´€É¢ á´˜Ê€á´á´„á´‡ss sá´›á´á´˜á´˜á´‡á´… ğŸ’—")
